@page "/"

<PageTitle>Home</PageTitle>

<h1>Blazor Server - Blue-Green Deployment POC</h1>

<div class="alert alert-primary" role="alert">
    <h4 class="alert-heading">🚀 State Persistence for Zero-Downtime Deployments</h4>
    <p>
        This application demonstrates how to use .NET 9's Blazor Server capabilities 
        to persist circuit state during blue-green deployments, ensuring a seamless 
        user experience with no state loss.
    </p>
</div>

<h2>How It Works</h2>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">📝 State Persistence</h5>
                <p class="card-text">
                    Component state is automatically saved to persistent storage 
                    (file system in this POC) whenever it changes.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">🔄 Graceful Shutdown</h5>
                <p class="card-text">
                    When the old server shuts down, all active circuit states 
                    are saved before termination.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">🎯 State Rehydration</h5>
                <p class="card-text">
                    When the new server starts and clients reconnect, their 
                    saved state is automatically restored.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">✨ Transparent Updates</h5>
                <p class="card-text">
                    Users experience seamless updates with no data loss or 
                    interruption to their workflow.
                </p>
            </div>
        </div>
    </div>
</div>

<h2>Try It Out</h2>

<ol>
    <li>Navigate to the <a href="/counter">Counter</a> page</li>
    <li>Increment the counter several times</li>
    <li>Note the circuit ID displayed on the page</li>
    <li>Restart the application (simulate blue-green deployment)</li>
    <li>Return to the Counter page - your count will be restored!</li>
</ol>

<div class="alert alert-success" role="alert">
    <strong>Production Note:</strong> In a real blue-green deployment scenario, you would use 
    a distributed cache (Redis, Azure Cache) or database instead of file storage for state 
    persistence across multiple server instances.
</div>

<h2>Architecture Components</h2>

<ul>
    <li><strong>ICircuitStateService:</strong> Interface for state persistence operations</li>
    <li><strong>FileBasedCircuitStateService:</strong> File-based implementation (POC)</li>
    <li><strong>ComponentStateManager:</strong> Scoped service for component-level state management</li>
    <li><strong>StateCircuitHandler:</strong> Tracks circuit lifecycle events</li>
    <li><strong>StatePreservationHostedService:</strong> Handles graceful shutdown and batch state saving</li>
</ul>

